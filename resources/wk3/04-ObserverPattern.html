<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>The Observer Pattern | Codeworks Workbook</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Resource for Codeworks Immersive FullStack Students">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.abb8cd21.css" as="style"><link rel="preload" href="/assets/js/app.ef1a9d1c.js" as="script"><link rel="preload" href="/assets/js/2.41bf532a.js" as="script"><link rel="preload" href="/assets/js/27.96e27fe4.js" as="script"><link rel="prefetch" href="/assets/js/10.c00206a1.js"><link rel="prefetch" href="/assets/js/11.f542a317.js"><link rel="prefetch" href="/assets/js/12.f9bfddc0.js"><link rel="prefetch" href="/assets/js/13.c983c316.js"><link rel="prefetch" href="/assets/js/14.beda3844.js"><link rel="prefetch" href="/assets/js/15.386c8797.js"><link rel="prefetch" href="/assets/js/16.73c5f2ea.js"><link rel="prefetch" href="/assets/js/17.707bdc0a.js"><link rel="prefetch" href="/assets/js/18.3da49663.js"><link rel="prefetch" href="/assets/js/19.a2dbb097.js"><link rel="prefetch" href="/assets/js/20.99fafe1c.js"><link rel="prefetch" href="/assets/js/21.c3b316d6.js"><link rel="prefetch" href="/assets/js/22.677dde93.js"><link rel="prefetch" href="/assets/js/23.80a360f1.js"><link rel="prefetch" href="/assets/js/24.3ba85630.js"><link rel="prefetch" href="/assets/js/25.1fef9ba0.js"><link rel="prefetch" href="/assets/js/26.fa48ad4e.js"><link rel="prefetch" href="/assets/js/28.b638b799.js"><link rel="prefetch" href="/assets/js/29.aed66f0a.js"><link rel="prefetch" href="/assets/js/3.bc041b8a.js"><link rel="prefetch" href="/assets/js/30.47261f8c.js"><link rel="prefetch" href="/assets/js/31.1ba2cc65.js"><link rel="prefetch" href="/assets/js/32.07a24d3a.js"><link rel="prefetch" href="/assets/js/33.599e6904.js"><link rel="prefetch" href="/assets/js/34.26aaf3a3.js"><link rel="prefetch" href="/assets/js/4.6878f2ea.js"><link rel="prefetch" href="/assets/js/5.7189ec79.js"><link rel="prefetch" href="/assets/js/6.40ece6a5.js"><link rel="prefetch" href="/assets/js/7.36978bb5.js"><link rel="prefetch" href="/assets/js/8.1831ce67.js"><link rel="prefetch" href="/assets/js/9.7367ef8b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.abb8cd21.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Codeworks Workbook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/resources/" class="nav-link router-link-active">
  Resources
</a></div><div class="nav-item"><a href="/vocab/" class="nav-link">
  Vocab
</a></div><div class="nav-item"><a href="https://boisecodeworks.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Codeworks
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/resources/" class="nav-link router-link-active">
  Resources
</a></div><div class="nav-item"><a href="/vocab/" class="nav-link">
  Vocab
</a></div><div class="nav-item"><a href="https://boisecodeworks.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Codeworks
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Student Resources</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Building Blocks Of Web Development</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Intro To Js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Advancing with Javascript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/resources/wk3/01-Modules.html" class="sidebar-link">ES6 modules</a></li><li><a href="/resources/wk3/02-Encapsulation.html" class="sidebar-link">Encapsulation in JavaScript</a></li><li><a href="/resources/wk3/03-Proxies.html" class="sidebar-link">An Intro to Javascript Proxy Objects</a></li><li><a href="/resources/wk3/04-ObserverPattern.html" aria-current="page" class="active sidebar-link">The Observer Pattern</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/resources/wk3/04-ObserverPattern.html#the-event-observer" class="sidebar-link">The Event Observer</a></li><li class="sidebar-sub-header"><a href="/resources/wk3/04-ObserverPattern.html#the-observer-pattern-in-action-a-blog-word-count-demo" class="sidebar-link">The Observer Pattern in Action: A Blog Word Count Demo</a></li><li class="sidebar-sub-header"><a href="/resources/wk3/04-ObserverPattern.html#looking-ahead" class="sidebar-link">Looking Ahead</a></li><li class="sidebar-sub-header"><a href="/resources/wk3/04-ObserverPattern.html#conclusion" class="sidebar-link">Conclusion</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Asynchronous Code</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="the-observer-pattern"><a href="#the-observer-pattern" class="header-anchor">#</a> The Observer Pattern</h1> <p>In JavaScript, there is a problem that comes up often. You need a way to update parts of a page in response to certain events, with the data these provide. Say, for example, user input that you then project into one or many components. This leads into a lot of push-and-pull in the code to keep everything in sync.</p> <p>This is where the observer design pattern can help --- it enables one-to-many data binding between elements. This one-way data binding can be event driven. With this pattern, you can build reusable code that solves for your specific needs.</p> <p>In this article, I'd like to explore the observer design pattern. It will help you solve a common problem you see in client-side scripting. That is one-to-many, one-way, and event-driven data binding. It is a problem that comes up often when you have many elements that must be in sync.</p> <p>I'll use ECMAScript 6 to illustrate the pattern. Yes, there will be classes, arrow functions, and constants. Feel free to explore these topics on your own if you are not already familiar. I'll use parts of ES6 that introduce syntactic sugar only, so it is portable with ES5 if need be.</p> <p>And I'll use Test-Driven-Development (TDD) to work on the pattern. This way you have a way knowing how each component is useful.</p> <p>The new language features in ES6 make for some succinct code. So, let's get started.</p> <h2 id="the-event-observer"><a href="#the-event-observer" class="header-anchor">#</a> The Event Observer</h2> <p>A high-level view of the pattern looks like this:</p> <div class="language- extra-class"><pre class="language-text"><code>EventObserver
│
├── subscribe: adds new observable events
│
├── unsubscribe: removes observable events
|
└── broadcast: executes all events with bound data
</code></pre></div><p>After I flesh out the observer pattern I'll add a word count that uses it. The word count component will take this observer and bring it all together.</p> <p>To initialize the <code>EventObserver</code> do:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">EventObserver</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Start with an empty list of observed events, and do this for every new instance. From now on, let's add more methods inside <code>EventObserver</code> to flesh out the design pattern.</p> <h3 id="the-subscribe-method"><a href="#the-subscribe-method" class="header-anchor">#</a> The Subscribe Method</h3> <p>To add new events do:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Grab the list of observed events and push a new item to the array. The list of events is a list of callback functions.</p> <p>One way to test this method in plain JavaScript is as follows:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Arrange</span>
<span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Act</span>
observer<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Assert</span>
assert<span class="token punctuation">.</span><span class="token function">strictEqual</span><span class="token punctuation">(</span>observer<span class="token punctuation">.</span>observers<span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>I use <a href="https://nodejs.org/api/assert.html" target="_blank" rel="noopener noreferrer">Node assertions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to test this component in Node. The exact same assertions exist as <a href="http://chaijs.com/api/assert/" target="_blank" rel="noopener noreferrer">Chai assertions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> too.</p> <p>Note the list of observed events consists of humble callbacks. We then check the length of the list and assert that the callback is on the list.</p> <h3 id="the-unsubscribe-method"><a href="#the-unsubscribe-method" class="header-anchor">#</a> The Unsubscribe Method</h3> <p>To remove events do:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">subscriber</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> subscriber <span class="token operator">!==</span> fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Filter out from the list whatever matches the callback function. If there is no match, the callback gets to stay on the list. The filter returns a new list and reassigns the list of observers.</p> <p>To test this nice method, do:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Arrange</span>
<span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

observer<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Act</span>
observer<span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Assert</span>
assert<span class="token punctuation">.</span><span class="token function">strictEqual</span><span class="token punctuation">(</span>observer<span class="token punctuation">.</span>observers<span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The callback must match the same function that's on the list. If there is a match, the unsubscribe method removes it from the list. Note the test uses the function reference to add and remove it.</p> <h3 id="the-broadcast-method"><a href="#the-broadcast-method" class="header-anchor">#</a> The Broadcast Method</h3> <p>To call all events do:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">broadcast</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">subscriber</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">subscriber</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This iterates through the list of observed events and executes all callbacks. With this, you get the necessary one-to-many relationship to the subscribed events. You pass in the <code>data</code> parameter which makes the callback data bound.</p> <p>ES6 makes the code more effective with an arrow function. Note the <code>(subscriber) =&gt; subscriber(data)</code> function that does most of the work. This one-liner arrow function benefits from this short ES6 syntax. This is a definite improvement in the JavaScript programming language.</p> <p>To test this broadcast method, do:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Arrange</span>
<span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> subscriberHasBeenCalled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> subscriberHasBeenCalled <span class="token operator">=</span> data<span class="token punctuation">;</span>

observer<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Act</span>
observer<span class="token punctuation">.</span><span class="token function">broadcast</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Assert</span>
<span class="token function">assert</span><span class="token punctuation">(</span>subscriberHasBeenCalled<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Use <code>let</code> instead of a <code>const</code> so we can change the value of the variable. This makes the variable mutable which allows me to reassign its value inside of the callback. Using a <code>let</code> in your code sends a signal to fellow programmers that the variable is changing at some point. This adds readability and clarity to your JavaScript code.</p> <p>This test gives me the confidence necessary to ensure the observer is working as I expect. With TDD, it is all about building reusable code in plain JavaScript. There are benefits to writing testable code in plain JavaScript. Test everything, and retain what is good for code reuse.</p> <p>With this, we have fleshed out the <code>EventObserver</code>. The question is, what can you build with this?</p> <h2 id="the-observer-pattern-in-action-a-blog-word-count-demo"><a href="#the-observer-pattern-in-action-a-blog-word-count-demo" class="header-anchor">#</a> The Observer Pattern in Action: A Blog Word Count Demo</h2> <p>For the demo, time to put in place a blog post where it keeps the word count for you. Every keystroke you enter as input will get synced by the observer design pattern. Think of it as free text input where every event fires an update to where you need it to go.</p> <p>To get a word count from free text input, one can do:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">getWordCount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> text <span class="token operator">?</span> text<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\s+</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
</code></pre></div><p>Done! There is a lot going on in this seemingly simple pure function, so how about a humble unit test? This way it is clear what I intended this to do:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Arrange</span>
<span class="token keyword">const</span> blogPost <span class="token operator">=</span> <span class="token string">'This is a blog \n\n  post with a word count.     '</span><span class="token punctuation">;</span>

<span class="token comment">// Act</span>
<span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">getWordCount</span><span class="token punctuation">(</span>blogPost<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Assert</span>
assert<span class="token punctuation">.</span><span class="token function">strictEqual</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Note the somewhat wacky input string inside <code>blogPost</code>. I intend for this function to cover as many edge cases as possible. As long as it gives me a proper word count we are heading, in fact, in the right direction.</p> <p>As a side note, this is the real power of TDD. One can iterate on this implementation and cover as many use cases as possible. The unit test tells you how I expect this to behave. If the behavior has a flaw, for any reason, it is easy to iterate and tweak it. With the test, there is enough evidence left behind for any other person to make changes.</p> <p>Time to wire up these reusable components to the DOM. This is the part where you get to wield plain JavaScript and weld it right into the browser.</p> <p>A way to do it would be to have the following HTML on the page:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>blogPost<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Enter your blog post...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>blogPost<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>word-count<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Word Count: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>strong</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>blog-word-count<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>strong</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Followed up by this JavaScript:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> blogObserver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

blogObserver<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> blogCount <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'blog-word-count'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  blogCount<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token function">getWordCount</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> blogPost <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'blogPost'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

blogPost<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'keyup'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> blogObserver<span class="token punctuation">.</span><span class="token function">broadcast</span><span class="token punctuation">(</span>blogPost<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>Take all your reusable code and put in place the observer design pattern. This will track changes in the text area and give you a word count right beneath it. I'm using the <code>body.appendChild()</code> in the DOM API to add this new element. Then, attaching the event listeners to bring it to life.</p> <p>Note with arrow functions it is possible to wire up one-liner events. In fact, you broadcast event-driven changes to all subscribers with this. The <code>() =&gt; blogObserver.broadcast()</code> does the bulk of the work here. It even passes in the latest changes to the text area right into the callback function. Yes, client-side scripting is super cool.</p> <p>No demo is complete without one you can touch and tweak, below is the CodePen:</p> <p data-height="265" data-theme-id="dark" data-default-tab="js,result" data-user="SitePoint" data-slug-hash="rzBEXP" data-pen-title="The Observer Pattern" class="codepen" style="height:400px;box-sizing:border-box;display:flex;align-items:center;justify-content:center;border:2px solid;margin:1em 0;padding:1em;"><span>See the Pen <a href="https://codepen.io/SitePoint/pen/rzBEXP">
  The Observer Pattern</a> by SitePoint (<a href="https://codepen.io/SitePoint">@SitePoint</a>)
  on <a href="https://codepen.io">CodePen</a>.</span></p> <script async="async" src="https://static.codepen.io/assets/embed/ei.js"></script> <p>Now, I would not call this feature complete. It is but a starting point of the observer design pattern. The question in my mind is, how far are you willing to go?</p> <h2 id="looking-ahead"><a href="#looking-ahead" class="header-anchor">#</a> Looking Ahead</h2> <p>It is up to you to take this idea even further. There are many ways you can use the observer design pattern to build new features.</p> <p>You can enhance the demo with:</p> <ul><li>Another component that counts the number of paragraphs</li> <li>Another component that shows a preview of entered text</li> <li>Enhance the preview with markdown support, for example</li></ul> <p>These are only a few ideas you can do to sink deeper into this. The enhancements above will challenge your programming chops.</p> <h2 id="conclusion"><a href="#conclusion" class="header-anchor">#</a> Conclusion</h2> <p>The observer design pattern can help you solve real-world problems in JavaScript. This solves the perennial problem of keeping a bunch of elements synced with the same data. As often is the case, when the browser fires specific events. I'm sure most of you by now have come across such a problem and have run towards tools and third-party dependencies.</p> <p>This design pattern equips you to go as far as your imagination is willing to go. In programming, you abstract the solution into a pattern and build reusable code. There is no limit to how far this will take you.</p> <p>I hope you see how much, with a little discipline and effort, you can do in plain JavaScript. The new features in the language, such as ES6, help you write some succinct code that is reusable.</p> <br> <br> <hr> <small>Reyes, Camilo. JavaScript Design Patterns: The Observer Pattern. 17 June 2018, www.sitepoint.com/javascript-design-patterns-observer-pattern/. </small> <br></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/resources/wk3/03-Proxies.html" class="prev">
        An Intro to Javascript Proxy Objects
      </a></span> <span class="next"><a href="/resources/wk4/01-Callbacks.html">
        Callback Hell
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ef1a9d1c.js" defer></script><script src="/assets/js/2.41bf532a.js" defer></script><script src="/assets/js/27.96e27fe4.js" defer></script>
  </body>
</html>
